{"title":"Data Processing","markdown":{"yaml":{"title":"Data Processing","author":"Ziquan 'Harrison' Liu","format":{"html":{"code-fold":true}}},"headingText":"Load raw data and perform initial cleaning","containsRefs":false,"markdown":"\n- Repository: Harvard Dataverse  \n- Dataset title: *Replication Data for: Low Transmission of the Globally Dominant Recombinant SARS-CoV-2 XFG variant in Kenya, May–July 2025*  \n- DOI: https://doi.org/10.7910/DVN/LJEYL6  \n- Year: 2025 \nThe replication data package comprises a primary analytic dataset (`Data1_xfg.csv`), a codebook detailing the variables, and a R Markdown script utilized to duplicate the original Table 1. For this project, I downloaded the complete package and stored `Data1_xfg.csv` in the local `data/` directory of the RStudio project (this file is not published to GitHub to maintain data-sharing boundaries).\nThe dataset comprises 21 RT-PCR-confirmed SARS-CoV-2 cases gathered between May and July 2025 from three surveillance platforms in coastal Kenya. Each row represents a single participant or sample.\n\n```{r load-data-processing}\n# This chunk reads the raw CSV file, cleans variable names,and creates derived variables needed for later analysis.\nlibrary(tidyverse) # data wrangling and visualization\nlibrary(lubridate) # date handling\nlibrary(janitor) # clean variable names\n\nData_xfg_raw <- readr::read_csv(\"data/Data1_xfg.csv\")\nData_xfg <- Data_xfg_raw %>%\n  janitor::clean_names() %>%\n  mutate(\n    date_collect = lubridate::dmy(date_collect),\n    lineage_group = if_else(\n      stringr::str_starts(nextclade_pango2, \"XFG\"),\n      \"XFG lineage\", \"Other lineages\"\n    ),\n    lineage_group = factor(lineage_group),\n    clinical_status = factor(clinical_status,\n                             levels = c(\"asymptomatic\", \"symptomatic\")),\n    study = factor(study,\n                   levels = c(\"HF\", \"pricos\", \"ResViRe\"))\n  )\n```\nFollowing the cleaning process, no observations were discarded; all 21 samples were preserved. The variable date_collect was transformed into a Date class with lubridate::dmy(). The lineage variable nextclade_pango2 was reclassified into a more straightforward two-level factor lineage_group (“XFG lineage” vs “Other lineages”). The variables study, clinical_status, and age_group were specifically designated as factors to guarantee uniform ordering in tables and figures. No imputation was conducted.\n\n# Exploratory plots\nThis section's charts aim to illustrate the age distribution of participants and the general prevalence of reported symptoms. Due to the limited sample size, these graphs should be interpreted as descriptive representations rather than accurate estimations.\n## Age distribution  \n```{r}\n# This chunk visualizes the distribution of participant ages (in years).\n# A simple histogram is used due to the small sample size.\n\nggplot(Data_xfg, aes(x = age_years)) + # map age_years to x-axis\ngeom_histogram(\nbins = 8, # choose a small number of bins\nfill = \"#2E86AB\", # bar color\nalpha = 0.8, # slight transparency\ncolor = \"white\" # white borders for readability\n) +\nlabs(\ntitle = \"Age distribution of SARS-CoV-2 positive participants\",\nx = \"Age (years)\",\ny = \"Count\"\n) +\ntheme_minimal()\n\n# Expected result: a histogram showing how the 21 participants are distributed across age, highlighting the mix of children, adolescents, and adults.\n```\n\n## Sample size by study\n```{r study-sample-size}\n# This chunk summarized how many observations were contributed by each study.\n# It gave context for later stratified analyses.\n\nstudy_counts <- Data_xfg %>%                 # start from the cleaned dataset\n  dplyr::count(study)                        # count number of rows per study\n\nggplot(\n  study_counts,\n  aes(\n    x = study,                               # x-axis: HF, pricos, ResViRe\n    y = n                                   # y-axis: number of samples\n  )\n) +\n  geom_col(\n    fill  = \"#6C5B7B\",                      # bar fill color\n    alpha = 0.85\n  ) +\n  labs(\n    title = \"Number of samples by study\",\n    x     = \"Study\",\n    y     = \"Sample size (N)\"\n  ) +\n  theme_minimal()\n\n# Expected result:A bar chart showing how many participants were included from each study,indicating the relative contribution of HF, pricos, and ResViRe.\n```\n\n## Number of reported symptoms per participant\n```{r}\n# This chunk counts, for each participant, how many different symptoms were reported, and then displays the distribution of this count.\n\n# 1. List the symptom variables to be considered.\nsymptom_vars <- c(\n\"sys_cough\", \"sys_headache\", \"sys_runny_nose\",\n\"sys_sore_throat\", \"sys_chestpain\", \"sys_fever\"\n)\n\n# 2. For each participant, count the number of symptoms with value \"Yes\".\nsymptom_counts <- Data_xfg %>%\nmutate(\nn_symptoms = rowSums(\nacross(\nall_of(symptom_vars),          # apply across the listed symptom variables\n~ .x == \"Yes\"                  # logical test: TRUE if symptom == \"Yes\"\n),\nna.rm = TRUE                     # treat NA as 0 when summing\n)\n)\n\n# 3. Plot the distribution of the count of reported symptoms.\nggplot(symptom_counts, aes(x = n_symptoms)) +\ngeom_bar(\nfill  = \"#F39C12\",                 # bar color\nalpha = 0.8\n) +\nlabs(\ntitle = \"Number of reported symptoms per participant\",\nx     = \"Number of symptoms\",\ny     = \"Count\"\n) +\ntheme_minimal()\n\n# Expected result: a bar chart showing how many participants reported 0, 1, 2, etc symptoms. This helps describe overall symptom burden in the small cohort.\n```\n\n## Overall Ct value distribution\n```{r ct-distribution}\n# This chunk visualizes the overall distribution of Ct values across all sequenced samples in the dataset.\n\nct_nonmiss <- Data_xfg %>%                   # start from the cleaned dataset\n  dplyr::filter(!is.na(ct_value))            # keep only records with non-missing Ct values\n\nggplot(\n  ct_nonmiss,\n  aes(x = ct_value)                          # x-axis: Ct value\n) +\n  geom_histogram(\n    bins  = 8,                               # number of histogram bins\n    fill  = \"#3498DB\",                       # bar fill color\n    alpha = 0.8,\n    color = \"white\"                          # bar border color\n  ) +\n  scale_x_reverse() +                        # reverse x-axis so lower Ct appears on the right\n  labs(\n    title = \"Distribution of Ct values among sequenced infections\",\n    x     = \"Ct value (lower = higher viral load)\",\n    y     = \"Count\"\n  ) +\n  theme_minimal()\n\n# Expected result: A histogram summarizing Ct values across all 21 samples, offering a quick overview of viral load levels before stratified analyses.\n```","srcMarkdownNoYaml":"\n- Repository: Harvard Dataverse  \n- Dataset title: *Replication Data for: Low Transmission of the Globally Dominant Recombinant SARS-CoV-2 XFG variant in Kenya, May–July 2025*  \n- DOI: https://doi.org/10.7910/DVN/LJEYL6  \n- Year: 2025 \nThe replication data package comprises a primary analytic dataset (`Data1_xfg.csv`), a codebook detailing the variables, and a R Markdown script utilized to duplicate the original Table 1. For this project, I downloaded the complete package and stored `Data1_xfg.csv` in the local `data/` directory of the RStudio project (this file is not published to GitHub to maintain data-sharing boundaries).\nThe dataset comprises 21 RT-PCR-confirmed SARS-CoV-2 cases gathered between May and July 2025 from three surveillance platforms in coastal Kenya. Each row represents a single participant or sample.\n\n```{r load-data-processing}\n# Load raw data and perform initial cleaning\n# This chunk reads the raw CSV file, cleans variable names,and creates derived variables needed for later analysis.\nlibrary(tidyverse) # data wrangling and visualization\nlibrary(lubridate) # date handling\nlibrary(janitor) # clean variable names\n\nData_xfg_raw <- readr::read_csv(\"data/Data1_xfg.csv\")\nData_xfg <- Data_xfg_raw %>%\n  janitor::clean_names() %>%\n  mutate(\n    date_collect = lubridate::dmy(date_collect),\n    lineage_group = if_else(\n      stringr::str_starts(nextclade_pango2, \"XFG\"),\n      \"XFG lineage\", \"Other lineages\"\n    ),\n    lineage_group = factor(lineage_group),\n    clinical_status = factor(clinical_status,\n                             levels = c(\"asymptomatic\", \"symptomatic\")),\n    study = factor(study,\n                   levels = c(\"HF\", \"pricos\", \"ResViRe\"))\n  )\n```\nFollowing the cleaning process, no observations were discarded; all 21 samples were preserved. The variable date_collect was transformed into a Date class with lubridate::dmy(). The lineage variable nextclade_pango2 was reclassified into a more straightforward two-level factor lineage_group (“XFG lineage” vs “Other lineages”). The variables study, clinical_status, and age_group were specifically designated as factors to guarantee uniform ordering in tables and figures. No imputation was conducted.\n\n# Exploratory plots\nThis section's charts aim to illustrate the age distribution of participants and the general prevalence of reported symptoms. Due to the limited sample size, these graphs should be interpreted as descriptive representations rather than accurate estimations.\n## Age distribution  \n```{r}\n# This chunk visualizes the distribution of participant ages (in years).\n# A simple histogram is used due to the small sample size.\n\nggplot(Data_xfg, aes(x = age_years)) + # map age_years to x-axis\ngeom_histogram(\nbins = 8, # choose a small number of bins\nfill = \"#2E86AB\", # bar color\nalpha = 0.8, # slight transparency\ncolor = \"white\" # white borders for readability\n) +\nlabs(\ntitle = \"Age distribution of SARS-CoV-2 positive participants\",\nx = \"Age (years)\",\ny = \"Count\"\n) +\ntheme_minimal()\n\n# Expected result: a histogram showing how the 21 participants are distributed across age, highlighting the mix of children, adolescents, and adults.\n```\n\n## Sample size by study\n```{r study-sample-size}\n# This chunk summarized how many observations were contributed by each study.\n# It gave context for later stratified analyses.\n\nstudy_counts <- Data_xfg %>%                 # start from the cleaned dataset\n  dplyr::count(study)                        # count number of rows per study\n\nggplot(\n  study_counts,\n  aes(\n    x = study,                               # x-axis: HF, pricos, ResViRe\n    y = n                                   # y-axis: number of samples\n  )\n) +\n  geom_col(\n    fill  = \"#6C5B7B\",                      # bar fill color\n    alpha = 0.85\n  ) +\n  labs(\n    title = \"Number of samples by study\",\n    x     = \"Study\",\n    y     = \"Sample size (N)\"\n  ) +\n  theme_minimal()\n\n# Expected result:A bar chart showing how many participants were included from each study,indicating the relative contribution of HF, pricos, and ResViRe.\n```\n\n## Number of reported symptoms per participant\n```{r}\n# This chunk counts, for each participant, how many different symptoms were reported, and then displays the distribution of this count.\n\n# 1. List the symptom variables to be considered.\nsymptom_vars <- c(\n\"sys_cough\", \"sys_headache\", \"sys_runny_nose\",\n\"sys_sore_throat\", \"sys_chestpain\", \"sys_fever\"\n)\n\n# 2. For each participant, count the number of symptoms with value \"Yes\".\nsymptom_counts <- Data_xfg %>%\nmutate(\nn_symptoms = rowSums(\nacross(\nall_of(symptom_vars),          # apply across the listed symptom variables\n~ .x == \"Yes\"                  # logical test: TRUE if symptom == \"Yes\"\n),\nna.rm = TRUE                     # treat NA as 0 when summing\n)\n)\n\n# 3. Plot the distribution of the count of reported symptoms.\nggplot(symptom_counts, aes(x = n_symptoms)) +\ngeom_bar(\nfill  = \"#F39C12\",                 # bar color\nalpha = 0.8\n) +\nlabs(\ntitle = \"Number of reported symptoms per participant\",\nx     = \"Number of symptoms\",\ny     = \"Count\"\n) +\ntheme_minimal()\n\n# Expected result: a bar chart showing how many participants reported 0, 1, 2, etc symptoms. This helps describe overall symptom burden in the small cohort.\n```\n\n## Overall Ct value distribution\n```{r ct-distribution}\n# This chunk visualizes the overall distribution of Ct values across all sequenced samples in the dataset.\n\nct_nonmiss <- Data_xfg %>%                   # start from the cleaned dataset\n  dplyr::filter(!is.na(ct_value))            # keep only records with non-missing Ct values\n\nggplot(\n  ct_nonmiss,\n  aes(x = ct_value)                          # x-axis: Ct value\n) +\n  geom_histogram(\n    bins  = 8,                               # number of histogram bins\n    fill  = \"#3498DB\",                       # bar fill color\n    alpha = 0.8,\n    color = \"white\"                          # bar border color\n  ) +\n  scale_x_reverse() +                        # reverse x-axis so lower Ct appears on the right\n  labs(\n    title = \"Distribution of Ct values among sequenced infections\",\n    x     = \"Ct value (lower = higher viral load)\",\n    y     = \"Count\"\n  ) +\n  theme_minimal()\n\n# Expected result: A histogram summarizing Ct values across all 21 samples, offering a quick overview of viral load levels before stratified analyses.\n```"},"formats":{"html":{"identifier":{"display-name":"HTML","target-format":"html","base-format":"html"},"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":"auto","echo":true,"output":true,"warning":false,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"ipynb-shell-interactivity":null,"plotly-connected":true,"message":false,"engine":"knitr"},"render":{"keep-tex":false,"keep-typ":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":true,"code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-min-runs":1,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[],"notebook-links":true},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","css":["styles.css"],"toc":true,"output-file":"Data Processing.html"},"language":{"toc-title-document":"Table of contents","toc-title-website":"On this page","related-formats-title":"Other Formats","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Source","other-links-title":"Other Links","code-links-title":"Code Links","launch-dev-container-title":"Launch Dev Container","launch-binder-title":"Launch Binder","article-notebook-label":"Article Notebook","notebook-preview-download":"Download Notebook","notebook-preview-download-src":"Download Source","notebook-preview-back":"Back to Article","manuscript-meca-bundle":"MECA Bundle","section-title-abstract":"Abstract","section-title-appendices":"Appendices","section-title-footnotes":"Footnotes","section-title-references":"References","section-title-reuse":"Reuse","section-title-copyright":"Copyright","section-title-citation":"Citation","appendix-attribution-cite-as":"For attribution, please cite this work as:","appendix-attribution-bibtex":"BibTeX citation:","appendix-view-license":"View License","title-block-author-single":"Author","title-block-author-plural":"Authors","title-block-affiliation-single":"Affiliation","title-block-affiliation-plural":"Affiliations","title-block-published":"Published","title-block-modified":"Modified","title-block-keywords":"Keywords","callout-tip-title":"Tip","callout-note-title":"Note","callout-warning-title":"Warning","callout-important-title":"Important","callout-caution-title":"Caution","code-summary":"Code","code-tools-menu-caption":"Code","code-tools-show-all-code":"Show All Code","code-tools-hide-all-code":"Hide All Code","code-tools-view-source":"View Source","code-tools-source-code":"Source Code","tools-share":"Share","tools-download":"Download","code-line":"Line","code-lines":"Lines","copy-button-tooltip":"Copy to Clipboard","copy-button-tooltip-success":"Copied!","repo-action-links-edit":"Edit this page","repo-action-links-source":"View source","repo-action-links-issue":"Report an issue","back-to-top":"Back to top","search-no-results-text":"No results","search-matching-documents-text":"matching documents","search-copy-link-title":"Copy link to search","search-hide-matches-text":"Hide additional matches","search-more-match-text":"more match in this document","search-more-matches-text":"more matches in this document","search-clear-button-title":"Clear","search-text-placeholder":"","search-detached-cancel-button-title":"Cancel","search-submit-button-title":"Submit","search-label":"Search","toggle-section":"Toggle section","toggle-sidebar":"Toggle sidebar navigation","toggle-dark-mode":"Toggle dark mode","toggle-reader-mode":"Toggle reader mode","toggle-navigation":"Toggle navigation","crossref-fig-title":"Figure","crossref-tbl-title":"Table","crossref-lst-title":"Listing","crossref-thm-title":"Theorem","crossref-lem-title":"Lemma","crossref-cor-title":"Corollary","crossref-prp-title":"Proposition","crossref-cnj-title":"Conjecture","crossref-def-title":"Definition","crossref-exm-title":"Example","crossref-exr-title":"Exercise","crossref-ch-prefix":"Chapter","crossref-apx-prefix":"Appendix","crossref-sec-prefix":"Section","crossref-eq-prefix":"Equation","crossref-lof-title":"List of Figures","crossref-lot-title":"List of Tables","crossref-lol-title":"List of Listings","environment-proof-title":"Proof","environment-remark-title":"Remark","environment-solution-title":"Solution","listing-page-order-by":"Order By","listing-page-order-by-default":"Default","listing-page-order-by-date-asc":"Oldest","listing-page-order-by-date-desc":"Newest","listing-page-order-by-number-desc":"High to Low","listing-page-order-by-number-asc":"Low to High","listing-page-field-date":"Date","listing-page-field-title":"Title","listing-page-field-description":"Description","listing-page-field-author":"Author","listing-page-field-filename":"File Name","listing-page-field-filemodified":"Modified","listing-page-field-subtitle":"Subtitle","listing-page-field-readingtime":"Reading Time","listing-page-field-wordcount":"Word Count","listing-page-field-categories":"Categories","listing-page-minutes-compact":"{0} min","listing-page-category-all":"All","listing-page-no-matches":"No matching items","listing-page-words":"{0} words","listing-page-filter":"Filter","draft":"Draft"},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"1.7.32","theme":"pulse","title":"Data Processing","author":"Ziquan 'Harrison' Liu"},"extensions":{"book":{"multiFile":true}}}},"projectFormats":["html"]}